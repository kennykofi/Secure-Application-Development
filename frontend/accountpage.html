<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/account.css">
    <title>Account Settings</title>
    <style>
        .hidden {
            display: none;
        }
        body {
            background-image: url('media/servicesbckg.png');
        }
    </style>
</head>
<body>

<nav role="navigation" class="sidebar">
    <ul class="sidebar-icons">
        <li><a href="index.html"><img src="media/homelogo.png" alt="Home"></a></li>
        <li><a href="#" id="settings-link"><img src="media/settingslogo.png" alt="Settings"></a></li>
        <li><a href="#loans" id="loans-link"><img src="media/pnghero_money-logo-download.png" alt="Loans"></a></li>
    </ul>
</nav>

<div class="settings">
    <h2>ACCOUNT SETTINGS</h2>
    <div id="s-pin-overlay" class="s-pin-overlay" style="display: none;">
        <!-- Create S-PIN Modal -->
        <div class="s-pin-modal" id="create-s-pin-modal">
            <h3>CREATE YOUR S-PIN</h3>
            <div class="pin-inputs">
                <input type="password" maxlength="1" readonly>
                <input type="password" maxlength="1" readonly>
                <input type="password" maxlength="1" readonly>
                <input type="password" maxlength="1" readonly>
            </div>
            <button class="confirm-btn" onclick="moveToConfirmSPIN()">Set S-PIN</button>
        </div>

        <!-- Confirm S-PIN Modal -->
        <div class="s-pin-modal" id="confirm-s-pin-modal" style="display: none;">
            <h3>CONFIRM YOUR S-PIN</h3>
            <div class="pin-inputs">
                <input type="password" maxlength="1" readonly>
                <input type="password" maxlength="1" readonly>
                <input type="password" maxlength="1" readonly>
                <input type="password" maxlength="1" readonly>
            </div>
            <button class="confirm-btn" onclick="confirmSPIN()">Confirm S-PIN</button>
        </div>
    </div>

    <div class="tabs">
        <button class="tab active" data-tab="contact-info">Contact Info</button>
        <button class="tab" data-tab="notifications">Notifications</button>
        <button class="tab" data-tab="change-s-pin">Change S-PIN</button>
        <button class="tab" data-tab="documents">Documents</button>
    </div>
    <div id="contact-info" class="info active">
        <!-- Contact Info Content Here -->
        <div class="field">
            <label for="name">Full name</label>
            <p id="name"></p>
        </div>
        <div class="field">
            <label for="email">E-mail</label>
            <input type="email" id="email" value="">
            <button class="change-button" data-require-pin="true" onclick="requestPinBeforeAction('changeEmail')">CHANGE</button>
        </div>
    </div>
    <div id="notifications" class="info">
        <h3>Notification Settings</h3>
        <button class="edit-all-button" data-require-pin="true" onclick="requestPinBeforeAction('editNotifications')">EDIT</button>
        <div class="setting">
            <span>Change of limit</span>
            <label class="switch">
                <input type="checkbox" checked disabled>
                <span class="slider round"></span>
            </label>
        </div>
        <div class="setting">
            <span>Transaction confirmation</span>
            <label class="switch">
                <input type="checkbox" disabled>
                <span class="slider round"></span>
            </label>
        </div>
        <div class="setting">
            <span>Confirmation of high amount purchase</span>
            <label class="switch">
                <input type="checkbox" disabled>
                <span class="slider round"></span>
            </label>
        </div>
        <div class="setting">
            <span>Unsuccessful payments</span>
            <label class="switch">
                <input type="checkbox" disabled>
                <span class="slider round"></span>
            </label>
        </div>
    </div>
    <div id="change-s-pin" class="info">
        <!-- Change S-PIN Content Here -->
    </div>
    <div id="documents" class="info">
        <h3>Documents</h3>
        <div class="setting">
            <span>Data Processing</span>
            <div class="controls">
                <label class="switch">
                    <input type="checkbox" checked disabled>
                    <span class="slider round"></span>
                </label>
            </div>
        </div>
        <div class="setting">
            <span>Marketing communications</span>
            <div class="controls">
                <button class="change-button" data-require-pin="true" onclick="requestPinBeforeAction('changeMarketing')">CHANGE</button>
                <label class="switch">
                    <input type="checkbox" checked>
                    <span class="slider round"></span>
                </label>
            </div>
        </div>
        <div class="setting">
            <span>Third-party sharing</span>
            <div class="controls">
                <button class="change-button" data-require-pin="true" onclick="requestPinBeforeAction('changeMarketing')">CHANGE</button>
                <label class="switch">
                    <input type="checkbox" checked>
                    <span class="slider round"></span>
                </label>
            </div>
        </div>
    </div>
</div>

<div id="loans" class="loans hidden">
    <h3>Loans</h3>
    <div class="loan-overview">
        <h4>Loan Summary</h4>
        <p>Total Loan Amount: $10,000</p>
        <p>Remaining Balance: $8,500</p>
        <p>Interest Rate: 5%</p>
        <p>Next Payment Due: 2024-06-01</p>
    </div>

    <!-- Apply for a New Loan Section -->
    <div class="apply-loan">
        <h4>Apply for a New Loan</h4>
        <form id="loan-application-form">
            <div class="field">
                <label for="loan-amount">Loan Amount</label>
                <input type="number" id="loan-amount" required>
            </div>
            <div class="field">
                <label for="loan-purpose">Loan Purpose</label>
                <input type="text" id="loan-purpose" required>
            </div>
            <div class="field">
                <label for="loan-term">Loan Term (months)</label>
                <input type="number" id="loan-term" required>
            </div>
            <div class="field">
                <label for="interest-rate">Interest Rate</label>
                <input type="number" id="interest-rate" required>
            </div>
            <button type="submit">Apply</button>
        </form>
    </div>

    <!-- Manage Existing Loans Section -->
    <div class="manage-loans">
        <h4>Manage Existing Loans</h4>
        <div class="loan-details">
            <h5>Loan 1</h5>
            <p>Loan Amount: $5,000</p>
            <p>Remaining Balance: $3,500</p>
            <p>Interest Rate: 4%</p>
            <p>Next Payment Due: 2024-06-01</p>
            <button onclick="makePayment()">Make a Payment</button>
            <button onclick="earlyRepayment()">Early Repayment</button>
        </div>
    </div>

    <!-- Notifications and Alerts Section -->
    <div class="loan-notifications">
        <h4>Notifications and Alerts</h4>
        <p>Set up and manage reminders for upcoming payments and rate change alerts.</p>
        <button onclick="setupNotifications()">Setup Notifications</button>
    </div>

    <!-- Customer Support Section -->
    <div class="loan-support">
        <h4>Customer Support</h4>
        <p>Need help with your loan? Contact our support team.</p>
        <button onclick="contactSupport()">Contact Support</button>
    </div>

    <!-- Additional Resources Section -->
    <div class="loan-resources">
        <h4>Additional Resources</h4>
        <p>Explore our articles and tools on managing loans and personal finances.</p>
        <button onclick="viewResources()">View Resources</button>
    </div>
</div>

<script src="app.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get('user_id');

    console.log('Fetching data for user_id:', userId); // Debugging line

    fetch(`/api/user/${userId}`)
      .then(response => {
        console.log('Response status:', response.status); // Log the response status
        return response.json();
      })
      .then(data => {
        console.log('API response:', data); // Debugging line

        if (data.message) {
          alert(data.message);
        } else {
          document.getElementById('name').innerText = data.full_name || 'Name not found';
          document.getElementById('email').value = data.email || 'Email not found';
        }
      })
      .catch(error => {
        console.error('Error fetching user data:', error);
      });
});
</script>
</body>
</html>
